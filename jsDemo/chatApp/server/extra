const MongoClient = require('mongodb').MongoClient;
const assert = require('assert');
const dbCred = require('./db_credentials');


let getConnection = () => {
    return new Promise((resolve, reject) => {
        try {
            MongoClient.connect(dbCred.url, { useNewUrlParser: true }, (err, client) => {
                return resolve(client);
            });
        } catch (e) {
            return reject(e);
        }

    })
}

module.exports = getConnection;




const MongoClient = require('mongodb').MongoClient;
const assert = require('assert');
const getConnection = require('../db/db_connection');

let loginModel = {};
let conn = getConnection();

loginModel.login = (req, res) => {
let r
    conn
        .then((client) => {
            // console.log("login: ", client)
            let db = client.db('wittybrains');
            let col = db.collection('users')
            r = col.find({}).toArray(function(err, docs) {
                assert.equal(err, null);
                console.log("Found the following records");
                console.log(docs)
            })
            res.send(r)
        })
        .catch(error => {
            console.error(error.message)
            res.send(error.message)
        })
}
module.exports = loginModel;
